{% extends 'postBoard/base.html' %}
{% block body_title %} Welcome {{ user }} ! {% endblock %}

{% block content %}
<a href="/profile" class="btn btn-info btn-large"><i class="icon-plus"></i> Post New Task</a>
<a href="/" class="btn btn-info btn-large"><i class = "icon-plus"></i> Logout</a>
<div style="margin-bottom:25px">
<br>
    <div>
        Filter by category:
        <select id="category" class="selectpicker" data-style="btn-primary">
            <option>Academic Tutoring</option>
            <option>House Moving/Cleaning</option>
            <option>Share Rides</option>
            <option>Other</option>
        </select>
        <br>
        <button onclick="filterFn()" class="btn btn-primary">
            Filter! 
        </button>
        <button onclick="window.location.href='/alltasks'" class="btn btn-primary">
            Show all tasks
        </button>
    </div>
</div>
<div class="containter">
        <div id="task_table">
            <table border="0" cellpadding="10" width="100%">
                <tr>
                    <td>Task Name</td>
                    <td>Task Category</td>
                    <td>Task Summary</td>
                    <td>Posted By</td>
                    <td></td>
                </tr>

            {% for task in allTasks %}
            <tr>
                <td><p>{{ task.title }}</p></td>
                <td><p>{{ task.category }}</p></td>
                <td><p>{{ task.summary }}</p></td>
                <td><p>{{ task.creator.username }}</p></td>
                <td></td>
            </tr>
            <tr>
                <td colspan="3">
                    <p>{{ task.description }}</p>
                    <p>
                        <a href="/" class="btn btn-info btn-large">Accept Task</a>
                    </p>
                </td>
            </tr>
            {% endfor %}
            </table>
        </div>
</div>

<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script>
    function filterFn(){
        var category = $('#category :selected').text();
        var url = "/alltasks?c=" + category;
        window.location.href = url;
    }
</script>
<script>
    $(function() {

          // Initially hide toggleable content
        $("td[colspan=3]").find("p").hide();

          // Click handler on entire table
        $("table").click(function(event) {

              // No bubbling up
            event.stopPropagation();

            var $target = $(event.target);

              // Open and close the appropriate thing
            if ( $target.closest("td").attr("colspan") > 1 ) {
                $target.slideUp();
            } else {
                $target.closest("tr").next().find("p").slideToggle();
            }                    
        });
    });
</script>
{% endblock %}


